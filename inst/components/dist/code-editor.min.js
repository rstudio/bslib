/*! bslib 0.9.0.9002 | (c) 2012-2025 RStudio, PBC. | License: MIT + file LICENSE */
var m=(t,n,e)=>new Promise((i,s)=>{var r=o=>{try{a(e.next(o))}catch(c){s(c)}},d=o=>{try{a(e.throw(o))}catch(c){s(c)}},a=o=>o.done?i(o.value):Promise.resolve(o.value).then(r,d);a((e=e.apply(t,n)).next())});var E=window.Shiny,L=E?E.InputBinding:class{};function T(t,n){E&&E.inputBindings.register(new t,"bslib."+n)}function p({headline:t="",message:n,status:e="warning"}){document.dispatchEvent(new CustomEvent("shiny:client-message",{detail:{headline:t,message:n,status:e}}))}function l(t,n){return Object.prototype.hasOwnProperty.call(t,n)&&t[n]!==void 0}var B="sql",M=2,U="github-light",D="github-dark",F=400,k=new Set,S=new WeakSet,g=null;function w(){if(g!==null)return g;let t=document.querySelector('script[src*="prism-code-editor"][src$="index.js"]');if(!t)throw new Error("Could not find prism-code-editor script element. Ensure the prism-code-editor dependency is properly loaded.");let n=t.getAttribute("src");if(!n)throw new Error("prism-code-editor script element has no src attribute");return g=new URL(n,document.baseURI).href.replace(/\/index\.js$/,""),g}function P(t,n){return m(this,null,function*(){if(k.has(t)||["plain","plaintext","text","txt"].includes(t))return;let e=t;t==="html"&&(e="markup"),yield import(`${n}/prism/languages/${e}.js`),k.add(t)})}var f=new Set;function _(t,n){if(f.has(t))return;let e=`code-editor-theme-${t}`;if(document.getElementById(e)){f.add(t);return}let i=document.createElement("link");i.id=e,i.rel="stylesheet",i.href=`${n}/themes/${t}.css`,i.addEventListener("load",()=>{f.add(t)}),i.addEventListener("error",()=>{console.error(`Failed to load code editor theme: ${t}`)}),document.head.appendChild(i)}function R(t,n,e,i){let s=()=>{let o=document.documentElement.getAttribute("data-bs-theme")==="dark"?t.dataset.themeDark||e:t.dataset.themeLight||n;_(o,i)};s();let r=new MutationObserver(()=>s());r.observe(document.documentElement,{attributes:!0,attributeFilter:["data-bs-theme"]}),t.darkLightObserver=r}function j(t){return m(this,null,function*(){if(S.has(t))return t.prismEditor;let n=t.querySelector(".code-editor");if(!n){p({headline:"Code Editor Initialization Error",message:"Expected to find `.code-editor` inside `.shiny-input-code-editor` container element.",status:"error"});return}let e=t.dataset.language||B,i=t.dataset.initialCode||"",s=t.dataset.themeLight||U,r=t.dataset.themeDark||D,d=t.dataset.readOnly==="true",a=t.dataset.lineNumbers!=="false",o=t.dataset.wordWrap==="true",c=parseInt(t.dataset.tabSize||String(M))||M,z=t.dataset.insertSpaces!=="false",u=w();yield P(e,u);let[{createEditor:O},{copyButton:H},{defaultCommands:x}]=yield Promise.all([import(`${u}/index.js`),import(`${u}/extensions/copyButton/index.js`),import(`${u}/extensions/commands.js`)]),h=O(n,{language:e,value:i,tabSize:c,insertSpaces:z,lineNumbers:a,wordWrap:o,readOnly:d},H(),x()),b=h.keyCommandMap.Enter;h.keyCommandMap.Enter=(y,I,A)=>y.metaKey||y.ctrlKey?(t.dispatchEvent(new CustomEvent("codeEditorUpdate")),n.classList.add("code-editor-submit-flash"),setTimeout(()=>{n.classList.remove("code-editor-submit-flash")},F),!0):b==null?void 0:b(y,I,A),t.prismEditor=h,S.add(t),R(t,s,r,u);let C=t.querySelector("textarea");return C&&C.addEventListener("blur",()=>{t.dispatchEvent(new CustomEvent("codeEditorUpdate"))}),h})}var v=class extends L{find(n){return $(n).find(".shiny-input-code-editor")}getValue(n){let e=n;return e.prismEditor?e.prismEditor.value:n.dataset.initialCode||""}setValue(n,e){let i=n;i.prismEditor?i.prismEditor.setOptions({value:e}):n.dataset.initialCode=e}subscribe(n,e){let i=n;i.isInitialized=j(i),i.isInitialized.then(()=>{e(!1)}).catch(r=>{p({headline:"Code Editor Initialization Error",message:"An error occurred while initializing the code editor. See console for details.",status:"error"}),console.error("Failed to initialize code editor:",r)});let s=()=>e(!0);n.addEventListener("codeEditorUpdate",s),i.codeEditorUpdateCallback=s}unsubscribe(n){let e=n,i=e.codeEditorUpdateCallback;i&&(n.removeEventListener("codeEditorUpdate",i),delete e.codeEditorUpdateCallback),e.darkLightObserver&&(e.darkLightObserver.disconnect(),delete e.darkLightObserver)}receiveMessage(n,e){return m(this,null,function*(){let i=n;i.isInitialized&&(yield i.isInitialized);let s=i.prismEditor;if(!s){p({headline:"Code Editor could not update",message:"An update was ignored because the editor is not yet initialized.",status:"warning"});return}let r={};if(l(e,"code")&&(r.value=e.code),l(e,"tab_size")&&(r.tabSize=e.tab_size),l(e,"indentation")&&(r.insertSpaces=e.indentation==="space"),l(e,"read_only")&&(r.readOnly=e.read_only),l(e,"line_numbers")&&(r.lineNumbers=e.line_numbers),l(e,"word_wrap")&&(r.wordWrap=e.word_wrap),Object.keys(r).length>0&&s.setOptions(r),l(e,"language")&&e.language){let d=e.language;if(d!==n.dataset.language){let a=w();try{yield P(d,a),n.dataset.language=d,s.setOptions({language:d}),s.update()}catch(o){p({headline:"Code Editor Language Load Error",message:`Failed to load language '${d}'. See console for details.`,status:"error"})}}}l(e,"theme_light")&&e.theme_light&&this._maybeLoadThemeForMode(n,e.theme_light,"themeLight",!1),l(e,"theme_dark")&&e.theme_dark&&this._maybeLoadThemeForMode(n,e.theme_dark,"themeDark",!0),n.dispatchEvent(new CustomEvent("codeEditorUpdate"))})}_maybeLoadThemeForMode(n,e,i,s){if(n.dataset[i]=e,document.documentElement.getAttribute("data-bs-theme")==="dark"===s){let a=w();_(e,a)}}getRatePolicy(){return{policy:"throttle",delay:300}}};T(v,"code-editor");
//# sourceMappingURL=code-editor.min.js.map
