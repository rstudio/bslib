/*! bslib 0.9.0.9002 | (c) 2012-2025 RStudio, PBC. | License: MIT + file LICENSE */
var h=(n,t,e)=>new Promise((r,s)=>{var i=o=>{try{a(e.next(o))}catch(u){s(u)}},d=o=>{try{a(e.throw(o))}catch(u){s(u)}},a=o=>o.done?r(o.value):Promise.resolve(o.value).then(i,d);a((e=e.apply(n,t)).next())});var b=window.Shiny,C=b?b.InputBinding:class{};function k(n,t){b&&b.inputBindings.register(new n,"bslib."+t)}function c(n,t){return Object.prototype.hasOwnProperty.call(n,t)&&n[t]!==void 0}var M=new Set,L=new WeakSet,l=null;function g(){if(l!==null)return l;let n=document.querySelector('script[src*="prism-code-editor"][src$="index.js"]');if(!n)return console.error("Could not find prism-code-editor script element"),l="",l;let t=n.getAttribute("src");return t?(l=new URL(t,document.baseURI).href.replace(/\/index\.js$/,""),l):(console.error("prism-code-editor script element has no src attribute"),l="",l)}function T(n,t){return h(this,null,function*(){if(M.has(n)||["plain","plaintext","text","txt"].includes(n))return;let e=n;n==="html"&&(e="markup");try{yield import(`${t}/prism/languages/${e}.js`),M.add(n)}catch(r){throw console.error(`Failed to load language '${n}':`,r),r}})}function f(n,t,e){let r=`code-editor-theme-${n}`,s=document.getElementById(r),i=document.createElement("link");i.id=r,i.rel="stylesheet",i.href=`${e}/themes/${t}.css`,document.head.appendChild(i),s&&i.addEventListener("load",()=>{s.remove()})}function B(n,t,e,r){let s=n.id,i=()=>{let u=document.documentElement.getAttribute("data-bs-theme")==="dark"?n.dataset.themeDark||e:n.dataset.themeLight||t;f(s,u,r)};i();let d=new MutationObserver(a=>{for(let o of a)o.type==="attributes"&&o.attributeName==="data-bs-theme"&&i()});d.observe(document.documentElement,{attributes:!0,attributeFilter:["data-bs-theme"]}),n._themeObserver=d}function H(n){return h(this,null,function*(){if(L.has(n))return n.prismEditor;let t=n.querySelector(".code-editor");if(!t){console.error("Could not find .code-editor inside .shiny-input-code-editor");return}let e=n.dataset.language||"sql",r=n.dataset.initialCode||"",s=n.dataset.themeLight||"github-light",i=n.dataset.themeDark||"github-dark",d=n.dataset.readOnly==="true",a=n.dataset.lineNumbers!=="false",o=n.dataset.wordWrap==="true",u=parseInt(n.dataset.tabSize||"2")||2,S=n.dataset.insertSpaces!=="false",m=g();yield T(e,m);let{createEditor:P}=yield import(`${m}/index.js`),{copyButton:_}=yield import(`${m}/extensions/copyButton/index.js`),{defaultCommands:O}=yield import(`${m}/extensions/commands.js`),p=P(t,{language:e,value:r,tabSize:u,insertSpaces:S,lineNumbers:a,wordWrap:o,readOnly:d},_(),O()),E=p.keyCommandMap.Enter;p.keyCommandMap.Enter=(y,x,z)=>y.metaKey||y.ctrlKey?(n.dispatchEvent(new CustomEvent("codeEditorUpdate")),t.classList.add("code-editor-submit-flash"),setTimeout(()=>{t.classList.remove("code-editor-submit-flash")},400),!0):E==null?void 0:E(y,x,z),n.prismEditor=p,L.add(n),B(n,s,i,m);let v=n.querySelector("textarea");return v&&v.addEventListener("blur",()=>{n.dispatchEvent(new CustomEvent("codeEditorUpdate"))}),p})}var w=class extends C{find(t){return $(t).find(".shiny-input-code-editor")}getValue(t){let e=t;return e.prismEditor?e.prismEditor.value:t.dataset.initialCode||""}setValue(t,e){let r=t;r.prismEditor?r.prismEditor.setOptions({value:e}):t.dataset.initialCode=e}subscribe(t,e){H(t).catch(i=>{console.error("Failed to initialize code editor:",i)});let s=()=>e(!0);t.addEventListener("codeEditorUpdate",s),t._codeEditorUpdateCallback=s}unsubscribe(t){let e=t,r=t._codeEditorUpdateCallback;r&&(t.removeEventListener("codeEditorUpdate",r),delete t._codeEditorUpdateCallback),e._themeObserver&&(e._themeObserver.disconnect(),delete e._themeObserver)}receiveMessage(t,e){let s=t.prismEditor;if(!s){console.warn("Cannot update code editor: editor not initialized");return}let i={};if(c(e,"code")&&(i.value=e.code),c(e,"tab_size")&&(i.tabSize=e.tab_size),c(e,"indentation")&&(i.insertSpaces=e.indentation==="space"),c(e,"read_only")&&(i.readOnly=e.read_only),c(e,"line_numbers")&&(i.lineNumbers=e.line_numbers),c(e,"word_wrap")&&(i.wordWrap=e.word_wrap),Object.keys(i).length>0&&s.setOptions(i),c(e,"language")&&e.language!==t.dataset.language){let d=g();T(e.language,d).then(()=>{t.dataset.language=e.language,s.setOptions({language:e.language}),s.update()}).catch(a=>{console.error(`Failed to change language to '${e.language}':`,a)})}if(c(e,"theme_light")&&(t.dataset.themeLight=e.theme_light,document.documentElement.getAttribute("data-bs-theme")!=="dark")){let o=g();f(t.id,e.theme_light,o)}if(c(e,"theme_dark")&&(t.dataset.themeDark=e.theme_dark,document.documentElement.getAttribute("data-bs-theme")==="dark")){let o=g();f(t.id,e.theme_dark,o)}t.dispatchEvent(new CustomEvent("codeEditorUpdate"))}getRatePolicy(){return{policy:"throttle",delay:300}}};k(w,"code-editor");
//# sourceMappingURL=code-editor.min.js.map
