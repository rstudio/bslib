/*! bslib 0.9.0.9002 | (c) 2012-2025 RStudio, PBC. | License: MIT + file LICENSE */
var h=(n,t,e)=>new Promise((r,o)=>{var i=a=>{try{d(e.next(a))}catch(c){o(c)}},s=a=>{try{d(e.throw(a))}catch(c){o(c)}},d=a=>a.done?r(a.value):Promise.resolve(a.value).then(i,s);d((e=e.apply(n,t)).next())});var b=window.Shiny,C=b?b.InputBinding:class{};function k(n,t){b&&b.inputBindings.register(new n,"bslib."+t)}function l(n,t){return Object.prototype.hasOwnProperty.call(n,t)&&n[t]!==void 0}var L=new Set,T=new WeakSet,u=null;function g(){if(u!==null)return u;let n=document.querySelector('script[src*="prism-code-editor"][src$="index.js"]');if(!n)return console.error("Could not find prism-code-editor script element"),u="",u;let t=n.getAttribute("src");return t?(u=new URL(t,document.baseURI).href.replace(/\/index\.js$/,""),u):(console.error("prism-code-editor script element has no src attribute"),u="",u)}function M(n,t){return h(this,null,function*(){if(L.has(n)||["plain","plaintext","text","txt"].includes(n))return;let e=n;n==="html"&&(e="markup");try{yield import(`${t}/prism/languages/${e}.js`),L.add(n)}catch(r){throw console.error(`Failed to load language '${n}':`,r),r}})}function f(n,t,e){let r=`code-editor-theme-${n}`,o=document.getElementById(r),i=document.createElement("link");i.id=r,i.rel="stylesheet",i.href=`${e}/themes/${t}.css`,document.head.appendChild(i),o&&i.addEventListener("load",()=>{o.remove()})}function B(n,t,e,r){let o=n.id,i=()=>{let c=document.documentElement.getAttribute("data-bs-theme")==="dark"?n.dataset.themeDark||e:n.dataset.themeLight||t;f(o,c,r)};i();let s=new MutationObserver(d=>{for(let a of d)a.type==="attributes"&&a.attributeName==="data-bs-theme"&&i()});s.observe(document.documentElement,{attributes:!0,attributeFilter:["data-bs-theme"]}),n._themeObserver=s}function H(n){return h(this,null,function*(){if(T.has(n))return n.prismEditor;let t=n.querySelector(".code-editor");if(!t){console.error("Could not find .code-editor inside .shiny-input-code-editor");return}let e=n.dataset.language||"sql",r=n.dataset.initialCode||"",o=n.dataset.themeLight||"github-light",i=n.dataset.themeDark||"github-dark",s=n.dataset.readOnly==="true",d=n.dataset.lineNumbers!=="false",a=n.dataset.wordWrap==="true",c=parseInt(n.dataset.tabSize||"2")||2,S=n.dataset.insertSpaces!=="false",m=g();yield M(e,m);let{createEditor:P}=yield import(`${m}/index.js`),{copyButton:_}=yield import(`${m}/extensions/copyButton/index.js`),{defaultCommands:O}=yield import(`${m}/extensions/commands.js`),p=P(t,{language:e,value:r,tabSize:c,insertSpaces:S,lineNumbers:d,wordWrap:a,readOnly:s},_(),O()),E=p.keyCommandMap.Enter;p.keyCommandMap.Enter=(y,x,z)=>y.metaKey||y.ctrlKey?(n.dispatchEvent(new CustomEvent("codeEditorUpdate")),t.classList.add("code-editor-submit-flash"),setTimeout(()=>{t.classList.remove("code-editor-submit-flash")},400),!0):E==null?void 0:E(y,x,z),n.prismEditor=p,T.add(n),B(n,o,i,m);let v=n.querySelector("textarea");return v&&v.addEventListener("blur",()=>{n.dispatchEvent(new CustomEvent("codeEditorUpdate"))}),p})}var w=class extends C{find(t){return $(t).find(".shiny-input-code-editor")}getValue(t){let e=t;return e.prismEditor?e.prismEditor.value:t.dataset.initialCode||""}setValue(t,e){let r=t;r.prismEditor?r.prismEditor.setOptions({value:e}):t.dataset.initialCode=e}subscribe(t,e){H(t).catch(i=>{console.error("Failed to initialize code editor:",i)});let o=()=>e(!0);t.addEventListener("codeEditorUpdate",o),t._codeEditorUpdateCallback=o}unsubscribe(t){let e=t,r=t._codeEditorUpdateCallback;r&&(t.removeEventListener("codeEditorUpdate",r),delete t._codeEditorUpdateCallback),e._themeObserver&&(e._themeObserver.disconnect(),delete e._themeObserver)}receiveMessage(t,e){let o=t.prismEditor;if(!o){console.warn("Cannot update code editor: editor not initialized");return}let i={};if(l(e,"code")&&(i.value=e.code),l(e,"tab_size")&&(i.tabSize=e.tab_size),l(e,"indentation")&&(i.insertSpaces=e.indentation==="space"),l(e,"read_only")&&(i.readOnly=e.read_only),l(e,"line_numbers")&&(i.lineNumbers=e.line_numbers),l(e,"word_wrap")&&(i.wordWrap=e.word_wrap),Object.keys(i).length>0&&o.setOptions(i),l(e,"language")&&e.language){let s=e.language;if(s!==t.dataset.language){let d=g();M(s,d).then(()=>{t.dataset.language=s,o.setOptions({language:s}),o.update()}).catch(a=>{console.error(`Failed to change language to '${s}':`,a)})}}if(l(e,"theme_light")&&e.theme_light){let s=e.theme_light;if(t.dataset.themeLight=s,document.documentElement.getAttribute("data-bs-theme")!=="dark"){let c=g();f(t.id,s,c)}}if(l(e,"theme_dark")&&e.theme_dark){let s=e.theme_dark;if(t.dataset.themeDark=s,document.documentElement.getAttribute("data-bs-theme")==="dark"){let c=g();f(t.id,s,c)}}t.dispatchEvent(new CustomEvent("codeEditorUpdate"))}getRatePolicy(){return{policy:"throttle",delay:300}}};k(w,"code-editor");
//# sourceMappingURL=code-editor.min.js.map
