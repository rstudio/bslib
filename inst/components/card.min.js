/*! bslib 0.4.2.9000 | (c) 2012-2023 RStudio, PBC. | License: MIT + file LICENSE */
"use strict";(()=>{var a=class{constructor(e){let t=i=>{for(let r of i)if(r.type==="childList"){for(let s of r.addedNodes)s.nodeType===Node.ELEMENT_NODE&&this._callback(s,this.config.added);for(let s of r.removedNodes)s.nodeType===Node.ELEMENT_NODE&&this._callback(s,this.config.removed)}};this.config=e,this.observer=new MutationObserver(t),document.readyState==="complete"?this.connect():document.addEventListener("DOMContentLoaded",()=>this.connect())}_callback(e,{selector:t,callback:i}){let r=e.matches(t),s=e.querySelector(t);!r&&!s||(r&&i(e),s&&e.querySelectorAll(t).forEach(d=>i(d)))}connect(){this._callback(document.body,this.config.added),this.observer.observe(document,{childList:!0,subtree:!0})}disconnect(){this.observer.disconnect()}};var b=window.Shiny?Shiny.InputBinding:class{};function l(c){let e=["[href]","input:not([disabled])","button:not([disabled])","select:not([disabled])","summary:not(:disabled)","details:not([disabled])","textarea:not([disabled])",'[tabindex]:not([tabindex="-1"]):not([disabled])'],t=c.querySelectorAll(e.join(", "));return Array.from(t)}var u=window.bootstrap?window.bootstrap.Tooltip:class{},n=class{constructor(e){e.removeAttribute(n.attr.ATTR_INIT),this.container=e,n.instanceMap.set(e,this);let t=new Event("resize");this.cardResizeObserver=new ResizeObserver(()=>{window.dispatchEvent(t)}),this.cardResizeObserver.observe(this.container),this._addEventListeners(),this._enableTooltips(),this._startShinyOutputResizeObserver(),this.overlay=this._createOverlay()}enterFullScreen(e){e&&e.preventDefault(),this.overlay.container.addEventListener("click",()=>this.exitFullScreen()),document.addEventListener("keyup",i=>this._exitFullScreenOnEscape(i),!1);let t=l(this.container);t.length>0?(t[0].focus(),this.lastFocusInterior=t[t.length-1]):(this.lastFocusInterior=this.overlay.anchor,this.container.contains(document.activeElement)||(this.prevFocusExterior=document.activeElement,this.prevFocusExterior.addEventListener("keydown",i=>this._entrapFocus(i),{once:!0}))),this.lastFocusInterior&&(this.lastFocusInterior.onkeydown=i=>{i.key==="Tab"&&!i.shiftKey&&(i.preventDefault(),this.overlay.anchor.focus())}),this.container.classList.add(n.attr.CLASS_FULL_SCREEN),document.body.classList.add(n.attr.CLASS_HAS_FULL_SCREEN),this.container.insertAdjacentElement("beforebegin",this.overlay.container)}exitFullScreen(){this.overlay.container.removeEventListener("click",()=>this.exitFullScreen()),this.lastFocusInterior&&(this.lastFocusInterior.onkeydown=null),document.removeEventListener("keyup",e=>this._exitFullScreenOnEscape(e),!1),this.overlay.container.remove(),this.container.classList.remove(n.attr.CLASS_FULL_SCREEN),document.body.classList.remove(n.attr.CLASS_HAS_FULL_SCREEN),this.lastFocusInterior=void 0,this.prevFocusExterior=void 0}destroy(){this._removeEventListeners(),this.cardResizeObserver.disconnect(),this.shinyOutputResizeObserver&&this.shinyOutputResizeObserver.disconnect(),n.instanceMap.delete(this.container)}_addEventListeners(){let e=this.container.querySelector(`:scope > .${n.attr.CLASS_FULL_SCREEN_ENTER}`);e&&e.addEventListener("click",t=>this.enterFullScreen(t))}_removeEventListeners(){let e=this.container.querySelector(`:scope > .${n.attr.CLASS_FULL_SCREEN_ENTER}`);e&&e.removeEventListener("click",t=>this.enterFullScreen(t))}_enableTooltips(){let e=`.${n.attr.CLASS_FULL_SCREEN_ENTER}[data-bs-toggle='tooltip']`;if(!this.container.querySelector(e))return;this.container.querySelectorAll(e).forEach(i=>new u(i))}_startShinyOutputResizeObserver(){$(document).on("shiny:value",e=>{let t=e.binding.el;this.container.contains(t)&&(t.dataset.bslibOutputObserver||(this.shinyOutputResizeObserver=new ResizeObserver(e.binding.onResize),this.shinyOutputResizeObserver.observe(t),t.dataset.bslibOutputObserver="true"))})}_exitFullScreenOnEscape(e){document.activeElement instanceof HTMLSelectElement||e.key==="Escape"&&this.exitFullScreen()}_entrapFocus(e){e instanceof KeyboardEvent&&this.container.matches(`.${n.attr.CLASS_FULL_SCREEN}`)&&e.key==="Tab"&&(e.preventDefault(),this.overlay.anchor.focus())}_createOverlay(){let e=document.createElement("div");e.id=n.attr.ID_FULL_SCREEN_OVERLAY,e.classList.add(n.attr.ID_FULL_SCREEN_OVERLAY);let t=document.createElement("a");return t.classList.add(n.attr.CLASS_FULL_SCREEN_EXIT),t.tabIndex=0,t.onclick=()=>this.exitFullScreen(),t.onkeyup=i=>{(i.key==="Enter"||i.key===" ")&&this.exitFullScreen()},t.onkeydown=i=>{var r;i.key==="Tab"&&i.shiftKey&&(i.preventDefault(),(r=this.lastFocusInterior)==null||r.focus())},t.innerHTML=this._overlayCloseHtml(),e.appendChild(t),{container:e,anchor:t}}_overlayCloseHtml(){return"Close <svg width:'20' height='20' fill='currentColor' class='bi bi-x-lg' viewBox='0 0 16 16'><path d='M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8 2.146 2.854Z'/></svg>"}static getInstance(e){return n.instanceMap.get(e)}static get observer(){return n.documentObserver}},o=n;o.attr={ATTR_INIT:"data-bslib-card-needs-init",CLASS_CARD:"bslib-card",CLASS_FULL_SCREEN:"bslib-full-screen",CLASS_HAS_FULL_SCREEN:"bslib-has-full-screen",CLASS_FULL_SCREEN_ENTER:"bslib-full-screen-enter",CLASS_FULL_SCREEN_EXIT:"bslib-full-screen-exit",ID_FULL_SCREEN_OVERLAY:"bslib-full-screen-overlay"},o.instanceMap=new WeakMap,o.documentObserver=new a({added:{selector:`.${n.attr.CLASS_CARD}[data-bslib-card-needs-init]`,callback:e=>{new n(e)}},removed:{selector:`.${n.attr.CLASS_CARD}`,callback:e=>{var t;(t=n.getInstance(e))==null||t.destroy()}}});window.bslib=window.bslib||{};window.bslib.Card=o;})();
//# sourceMappingURL=card.min.js.map
